{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/sondrey/Downloads/v0-teaterplattform-utviklingsplan-main%202/lib/supabase/server.ts"],"sourcesContent":["import { createServerClient } from \"@supabase/ssr\"\nimport { createClient } from \"@supabase/supabase-js\"\nimport { cookies } from \"next/headers\"\n\nexport async function getSupabaseServerClient() {\n  const cookieStore = await cookies()\n\n  return createServerClient(process.env.NEXT_PUBLIC_SUPABASE_URL!, process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!, {\n    cookies: {\n      getAll() {\n        return cookieStore.getAll()\n      },\n      setAll(cookiesToSet) {\n        try {\n          cookiesToSet.forEach(({ name, value, options }) => cookieStore.set(name, value, options))\n        } catch {\n          // Server Component - ignore\n        }\n      },\n    },\n  })\n}\n\nexport async function getSupabaseAdminClient() {\n  // Use createClient with service role key to bypass RLS\n  // Do NOT use createServerClient with service role key - it still respects RLS\n  return createClient(process.env.NEXT_PUBLIC_SUPABASE_URL!, process.env.SUPABASE_SERVICE_ROLE_KEY!, {\n    auth: {\n      autoRefreshToken: false,\n      persistSession: false,\n    },\n  })\n}\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;AACA;AACA;;;;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IAEjC,OAAO,IAAA,iMAAkB,sUAAoF;QAC3G,SAAS;YACP;gBACE,OAAO,YAAY,MAAM;YAC3B;YACA,QAAO,YAAY;gBACjB,IAAI;oBACF,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAAK,YAAY,GAAG,CAAC,MAAM,OAAO;gBAClF,EAAE,OAAM;gBACN,4BAA4B;gBAC9B;YACF;QACF;IACF;AACF;AAEO,eAAe;IACpB,uDAAuD;IACvD,8EAA8E;IAC9E,OAAO,IAAA,yLAAY,gFAAwC,QAAQ,GAAG,CAAC,yBAAyB,EAAG;QACjG,MAAM;YACJ,kBAAkB;YAClB,gBAAgB;QAClB;IACF;AACF"}},
    {"offset": {"line": 90, "column": 0}, "map": {"version":3,"sources":["file:///Users/sondrey/Downloads/v0-teaterplattform-utviklingsplan-main%202/app/api/seats/cleanup/route.ts"],"sourcesContent":["import { type NextRequest, NextResponse } from \"next/server\"\nimport { getSupabaseAdminClient } from \"@/lib/supabase/server\"\n\nexport async function POST(request: NextRequest) {\n  try {\n    const supabase = await getSupabaseAdminClient()\n    const now = new Date().toISOString()\n\n    // Clear expired reservations\n    const { error: expiredError } = await supabase\n      .from(\"seats\")\n      .update({ status: \"available\", reserved_until: null })\n      .lt(\"reserved_until\", now)\n      .eq(\"status\", \"reserved\")\n\n    // Also clear seats with null reserved_until but status reserved (cleanup)\n    const { error: nullReservedError } = await supabase\n      .from(\"seats\")\n      .update({ status: \"available\", reserved_until: null })\n      .is(\"reserved_until\", null)\n      .eq(\"status\", \"reserved\")\n\n    if (expiredError || nullReservedError) {\n      console.error(\"[v0] Seats cleanup error:\", { expiredError, nullReservedError })\n      return NextResponse.json({ success: false, error: \"Kunne ikke rense setereservasjoner\" }, { status: 500 })\n    }\n\n    return NextResponse.json({ success: true })\n  } catch (err) {\n    console.error(\"[v0] Seats cleanup error:\", err)\n    return NextResponse.json({ success: false, error: \"Intern serverfeil\" }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,WAAW,MAAM,IAAA,qJAAsB;QAC7C,MAAM,MAAM,IAAI,OAAO,WAAW;QAElC,6BAA6B;QAC7B,MAAM,EAAE,OAAO,YAAY,EAAE,GAAG,MAAM,SACnC,IAAI,CAAC,SACL,MAAM,CAAC;YAAE,QAAQ;YAAa,gBAAgB;QAAK,GACnD,EAAE,CAAC,kBAAkB,KACrB,EAAE,CAAC,UAAU;QAEhB,0EAA0E;QAC1E,MAAM,EAAE,OAAO,iBAAiB,EAAE,GAAG,MAAM,SACxC,IAAI,CAAC,SACL,MAAM,CAAC;YAAE,QAAQ;YAAa,gBAAgB;QAAK,GACnD,EAAE,CAAC,kBAAkB,MACrB,EAAE,CAAC,UAAU;QAEhB,IAAI,gBAAgB,mBAAmB;YACrC,QAAQ,KAAK,CAAC,6BAA6B;gBAAE;gBAAc;YAAkB;YAC7E,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;gBAAO,OAAO;YAAqC,GAAG;gBAAE,QAAQ;YAAI;QAC1G;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAK;IAC3C,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAO,OAAO;QAAoB,GAAG;YAAE,QAAQ;QAAI;IACzF;AACF"}}]
}